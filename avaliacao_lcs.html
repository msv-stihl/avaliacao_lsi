<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/style_lcs.css">
    <title>Avaliação Limpeza Convencional</title>
    <style>
        .bloco-avaliacao { display: none; }
    </style>
</head>
<body>
<div class="screen">
<form class="form" id="form">
    <div class="header">
        <h1 class="title">Avaliação de Eficácia | Limpeza Convencional</h1>
        <input type="hidden" name="sheetName" id="sheetName" value="lco">

        <div class="tipo-avaliacao">
            <label for="tipo">Tipo de Avaliação:</label>
            <select name="tipo" id="tipo" required>
                <option value="">Selecione...</option>
                <option value="sala">Sala</option>
                <option value="banheiro">Banheiro</option>
                <option value="piso">Limpeza de Piso</option>
                <option value="escadaria">Limpeza de Escadaria</option>
                <option value="residuo">Recolhimento de Resíduo</option>
                <option value="papelao">Recolhimento de Papelão</option>
            </select>
        </div>

        <div class="nome">
            <label for="nome">Digite seu nome:</label>
            <input type="text" name="nome" id="nome" required>
        </div>

        <div class="predio">
            <label for="predio">Selecione o prédio:</label>
            <select id="predios" name="predios" class="predio-selecao" required>
                <option value="P01">P01</option>
                <option value="P02">P02</option>
                <option value="P03">P03</option>
                <option value="P04">P04</option>
                <option value="P07">P07</option>
                <option value="P08">P08</option>
                <option value="P11">P11</option>
                <option value="P15">P15</option>
                <option value="P16">P16</option>
                <option value="P18">P18</option>
                <option value="P20">P20</option>
                <option value="P22">P22</option>
                <option value="P26">P26</option>
                <option value="P27">P27</option>
                <option value="P28">P28</option>
                <option value="P29">P29</option>
                <option value="P30">P30</option>
                <option value="P31">P31</option>
                <option value="P32">P32</option>
                <option value="P35">P35</option>
                <option value="P37">P37</option>
                <option value="P38">P38</option>
                <option value="P42">P42</option>
                <option value="P43">P43</option>
                <option value="P48">P48</option>
                <option value="P49">P49</option>
                <option value="P50">P50</option>
                <option value="P52">P52</option>
                <option value="P56">P56</option>
            </select>
        </div>

        <div class="local">
            <label for="local">Local avaliado:</label>
            <input type="text" name="local" id="local" required>
        </div>
    </div>

    <!-- Bloco Sala -->
    <div id="bloco-sala" class="grid bloco-avaliacao">
        <div class="row"><label class="label">Abastecimento de insumos</label><div class="options"><input type="radio" name="abastecimento" value="1" class="button_happy" required><input type="radio" name="abastecimento" value="0" class="button_sad"><input type="radio" name="abastecimento" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Recolhimento de resíduos</label><div class="options"><input type="radio" name="recolhimento" value="1" class="button_happy" required><input type="radio" name="recolhimento" value="0" class="button_sad"><input type="radio" name="recolhimento" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de móveis</label><div class="options"><input type="radio" name="moveis" value="1" class="button_happy" required><input type="radio" name="moveis" value="0" class="button_sad"><input type="radio" name="moveis" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de vidros</label><div class="options"><input type="radio" name="vidros" value="1" class="button_happy" required><input type="radio" name="vidros" value="0" class="button_sad"><input type="radio" name="vidros" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de piso</label><div class="options"><input type="radio" name="piso" value="1" class="button_happy" required><input type="radio" name="piso" value="0" class="button_sad"><input type="radio" name="piso" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de parede</label><div class="options"><input type="radio" name="parede" value="1" class="button_happy" required><input type="radio" name="parede" value="0" class="button_sad"><input type="radio" name="parede" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de portas</label><div class="options"><input type="radio" name="portas" value="1" class="button_happy" required><input type="radio" name="portas" value="0" class="button_sad"><input type="radio" name="portas" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de janelas</label><div class="options"><input type="radio" name="janelas" value="1" class="button_happy" required><input type="radio" name="janelas" value="0" class="button_sad"><input type="radio" name="janelas" value="2" class="button_na" checked></div></div>
    </div>

    <!-- Bloco Banheiro -->
    <div id="bloco-banheiro" class="grid bloco-avaliacao">
        <div class="row"><label class="label">Abastecimento de insumos</label><div class="options"><input type="radio" name="banheiro_abastecimento" value="1" class="button_happy" required><input type="radio" name="banheiro_abastecimento" value="0" class="button_sad"><input type="radio" name="banheiro_abastecimento" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Recolhimento de resíduos</label><div class="options"><input type="radio" name="banheiro_recolhimento" value="1" class="button_happy" required><input type="radio" name="banheiro_recolhimento" value="0" class="button_sad"><input type="radio" name="banheiro_recolhimento" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de pias</label><div class="options"><input type="radio" name="pias" value="1" class="button_happy" required><input type="radio" name="pias" value="0" class="button_sad"><input type="radio" name="pias" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de espelhos</label><div class="options"><input type="radio" name="espelhos" value="1" class="button_happy" required><input type="radio" name="espelhos" value="0" class="button_sad"><input type="radio" name="espelhos" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de vasos sanitários</label><div class="options"><input type="radio" name="vasos" value="1" class="button_happy" required><input type="radio" name="vasos" value="0" class="button_sad"><input type="radio" name="vasos" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de mictórios</label><div class="options"><input type="radio" name="mictorios" value="1" class="button_happy" required><input type="radio" name="mictorios" value="0" class="button_sad"><input type="radio" name="mictorios" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de vidros</label><div class="options"><input type="radio" name="banheiro_vidros" value="1" class="button_happy" required><input type="radio" name="banheiro_vidros" value="0" class="button_sad"><input type="radio" name="banheiro_vidros" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de piso</label><div class="options"><input type="radio" name="banheiro_piso" value="1" class="button_happy" required><input type="radio" name="banheiro_piso" value="0" class="button_sad"><input type="radio" name="banheiro_piso" value="2" class="button_na" checked></div></div>
    </div>

    <!-- Bloco Piso -->
    <div id="bloco-piso" class="grid bloco-avaliacao">
        <div class="row"><label class="label">Limpeza de piso</label><div class="options"><input type="radio" name="lpiso" value="1" class="button_happy" required><input type="radio" name="lpiso" value="0" class="button_sad"><input type="radio" name="lpiso" value="2" class="button_na" checked></div></div>
    </div>

    <!-- Bloco Escadaria -->
    <div id="bloco-escadaria" class="grid bloco-avaliacao">
        <div class="row"><label class="label">Limpeza dos degraus</label><div class="options"><input type="radio" name="escada_degraus" value="1" class="button_happy" required><input type="radio" name="escada_degraus" value="0" class="button_sad"><input type="radio" name="escada_degraus" value="2" class="button_na" checked></div></div>
        <div class="row"><label class="label">Limpeza de corrimãos</label><div class="options"><input type="radio" name="escada_corrimao" value="1" class="button_happy" required><input type="radio" name="escada_corrimao" value="0" class="button_sad"><input type="radio" name="escada_corrimao" value="2" class="button_na" checked></div></div>
    </div>

    <!-- Bloco Resíduo -->
    <div id="bloco-residuo" class="grid bloco-avaliacao">
        <div class="row"><label class="label">Recolhimento de resíduos</label><div class="options"><input type="radio" name="rresiduo" value="1" class="button_happy" required><input type="radio" name="rresiduo" value="0" class="button_sad"><input type="radio" name="rresiduo" value="2" class="button_na" checked></div></div>
    </div>

    <!-- Bloco Papelão -->
    <div id="bloco-papelao" class="grid bloco-avaliacao">
        <div class="row"><label class="label">Recolhimento de papelão</label><div class="options"><input type="radio" name="rpapelao" value="1" class="button_happy" required><input type="radio" name="rpapelao" value="0" class="button_sad"><input type="radio" name="rpapelao" value="2" class="button_na" checked></div></div>
    </div>

    <input type="hidden" name="date" id="date" value="">
    <div class="submit">
        <input type="submit" name="submit" id="submit" class="submit-button" value="Enviar">
    </div>
</form>
</div>
<script>
    function getDate() {
        const date = new Date().toLocaleString();
        document.getElementById('date').value = date;
    }

    document.getElementById('tipo').addEventListener('change', function() {
        document.querySelectorAll('.bloco-avaliacao').forEach(bloco => bloco.style.display = 'none');
        const selecionado = this.value;
        const blocoSelecionado = document.getElementById('bloco-' + selecionado);
        if (blocoSelecionado) blocoSelecionado.style.display = 'grid';
    });

    const form = document.getElementById("form");
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        getDate();
        const formData = new FormData(form);
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxg5oupSu7G5P2rV4OqR6qTvMgYKxHWRNyW8hYaAIkZnhaH8Dq-idl3-MYv94aYfyAr/exec';

        fetch(scriptURL, { method: 'POST', body: formData })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Erro na resposta do servidor.');
                }
                return response.json();
            })
            .then(data => {
                if (data.result === 'success') {
                    alert("Resposta enviada!");
                    form.reset();
                    document.querySelectorAll('.bloco-avaliacao').forEach(b => b.style.display = 'none');
                } else {
                    console.error('Erro no retorno:', data.error);
                    alert("Ocorreu um erro ao processar sua resposta.");
                }
            })
            .catch(error => {
                console.error('Erro na requisição:', error);
                alert("Erro de conexão. Verifique sua internet ou tente novamente.");
            });

    });
</script>
</body>
</html>